$(document).ready((function(){$.validator.setDefaults({debug:false,highlight:function(element,errorClass,validClass){if($(element).parent().is("div")||$(element).parent().is("p")){if($(element).parent().hasClass("input-group")){$(element).parent().parent().addClass("has-error has-feedback")}else{if(!$(element).parent().hasClass("has-error"))$(element).parent().append('<span class="fa fa-warning form-control-feedback" aria-hidden="true"></span>');$(element).parent().addClass("has-error has-feedback")}}else if($(element).is('[type="radio"]')){$(element).parent().parent().addClass("has-error").parent().addClass("has-error")}},unhighlight:function(element,errorClass,validClass){if($(element).parent().is("div")||$(element).parent().is("p")){if($(element).parent().hasClass("input-group")){$(element).parent().parent().removeClass("has-error has-feedback")}else{if($(element).parent().hasClass("has-error"))$(element).next(".fa").remove();$(element).parent().removeClass("has-error has-feedback")}}else if($(element).is('[type="radio"]')){$(element).parent().parent().removeClass("has-error").parent().removeClass("has-error")}},errorPlacement:function(error,element){if(element.is(":radio")){element.parent().parent().parent().append(error)}else if(element.is(":checkbox")){error.insertAfter(element)}else if(element.is("select")){error.insertAfter(element)}else if(element.is(".checkMail")){error.insertAfter(element.next())}else if(element.is("#cryptpass")){error.insertAfter(element.next());$("<br />").insertBefore(error)}else{if(element.next().is(":button")||element.next().is(":file")){error.insertAfter(element);$("<br />").insertBefore(error)}else if(element.next().is(":submit")){error.insertAfter(element.next());$("<br />").insertBefore(error)}else{if($(element).parent().hasClass("input-group")){error.insertAfter(element.parent())}else{error.insertAfter(element)}}}},errorClass:"help-block error",errorElement:"span",validClass:"success",success:function(label){label.remove()}});$.jmRequest.notifier={cssClass:".mc-message"}}));var globalForm=function($,undefined){function redirect(loc,timeout){timeout=typeof timeout!=="undefined"?timeout:2800;setTimeout((function(){window.location.href=loc}),timeout)}function displayLoader(f,closeForm){closeForm=typeof closeForm!=="undefined"?closeForm:true;var loader=$(document.createElement("div")).addClass("loader pull-right").append($(document.createElement("i")).addClass("fa fa-spinner fa-pulse fa-2x fa-fw"),$(document.createElement("span")).append("Op√©ration en cours...").addClass("sr-only"));if(closeForm)$(f).collapse();$('button[type="submit"]').parent().empty().append(loader)}function removeLoader(f,closeForm){closeForm=typeof closeForm!=="undefined"?closeForm:true;if(closeForm)$(f).collapse("hide");$(".loader").parent().empty()}function initAlert(m,timeout,sub){sub=typeof sub!=="undefined"?sub:false;timeout=typeof timeout!=="undefined"?timeout:false;if(sub)$.jmRequest.notifier={cssClass:".mc-message-"+sub};$.jmRequest.initbox(m,{display:true});if(timeout)window.setTimeout((function(){$(".mc-message .alert").alert("close")}),timeout)}function successHandler(f,controller,sub){var options={handler:"submit",url:$(f).attr("action"),method:"post",form:$(f),resetForm:false,success:function(d){if(d.debug!=undefined&&d.debug!=""){initAlert(d.debug)}else if(d.notify!=undefined&&d.notify!=""){initAlert(d.notify,4e3)}}};if($(f).hasClass("add_form")){options.beforeSend=function(){displayLoader(f)};options.success=function(d){removeLoader(f);$.jmRequest.initbox(d.notify,{display:true});redirect(controller)}}else if($(f).hasClass("config_form")){options.beforeSend=function(){displayLoader(f)};options.success=function(d){removeLoader(f);$.jmRequest.initbox(d.notify,{display:false});redirect(controller)}}else if($(f).hasClass("pwd_form")){options.resetForm=true}$.jmRequest(options)}function initValidation(controller,form,sub){form=typeof form!=="undefined"?form:".validate_form";sub=typeof sub!=="undefined"?sub:false;$(form).each((function(){$(this).removeData();$(this).off();$(this).validate({ignore:[],onsubmit:true,event:"submit",submitHandler:function(f,e){e.preventDefault();successHandler(f,controller,sub);return false}})}))}return{run:function(controller){$.gForms=globalForm;initValidation(controller)}}}(jQuery);