//
// Buttons creation functions
//

// button-gradient-variant override
.button-size(@padding-vertical; @padding-horizontal; @font-size; @line-height; @border-radius) {
	--btn-padding-vertical: @padding-vertical;
	--btn-padding-horizontal: @padding-horizontal;
	--btn-font-size: @font-size;
	--btn-line-height: @line-height;
	--btn-border-radius: @border-radius;
}

.button-variant(@color; @bgch; @bgcs; @bgcl; @bgca; @brdch; @brdcs; @brdcl; @brdca) {
	--btn-color: @color;
	--btn-bg-h: @bgch;
	--btn-bg-s: @bgcs;
	--btn-bg-l: @bgcl;
	--btn-bg-a: @bgca;
	--btn-brd-h: @brdch;
	--btn-brd-s: @brdcs;
	--btn-brd-l: @brdcl;
	--btn-brd-a: @brdca;
	//--btn-bg-color: @background;
	//--btn-border-color: @border;
	//--btn-hover-bg-color: darken(@background, 10%);
	//--btn-ahf-bg-color: darken(@background, 17%);
	//--btn-hover-border-color: darken(@border, 12%);
	//--btn-focus-border-color: darken(@border, 25%);
}

/*.button-gradient-variant(@color; @bg-color-1; @bg-color-2;) {
	.button-variant(@color; @bg-color-1; transparent);
	background-repeat: repeat-x;
	--btn-bg-img: linear-gradient(45deg, @bg-color-1, @bg-color-2);
	--btn-hover-bg-img: linear-gradient(45deg, darken(@bg-color-1, 10%), darken(@bg-color-2, 10%));
	--btn-ahf-bg-img: linear-gradient(45deg, darken(@bg-color-1, 17%), darken(@bg-color-2, 17%));
	border: none;
}*/
// Button gradient Style
// @hv-color {color} background color on hover
// @hv-txt {color} text color on hover with auto by default
// @base-color {color} base border color | default: main text color
// @dark-color {color} second color
// @base-txt {color} base text color | default: main text color
.button-gradient(@hv-color; @hv-txt: auto; @base-color; @dark-color; @base-txt) {
	// 1. Calcul automatique des contrastes pour chaque état
	// On se base sur @hv-color pour le repos et @dark-color pour le hover
	@final-txt-normal: if(@hv-txt = auto, contrast(@hv-color, #000, #fff), @hv-txt);
	@final-txt-hover:  if(@hv-txt = auto, contrast(@dark-color, #000, #fff), @hv-txt);

	--btn-color: @final-txt-normal;

	background-origin: border-box;
	background-clip: border-box;
	border: 1px solid transparent;
	position: relative;
	z-index: 1;

	// Dégradé "double" (Normal | Hover)
	background-image: linear-gradient(90deg,
	@hv-color 0%, @base-color 50%,
	@dark-color 50%, @base-txt 100%
	);

	background-size: 200% 100%;
	background-position: left center;
	color: var(--btn-color);

	transition: background-position 0.25s ease, color 0.25s ease;

	&:hover {
		// On applique la couleur de texte calculée pour le hover
		--btn-color: @final-txt-hover;
		background-position: right center;
	}
}

// Button invert Style
// @hv-color {color} background color on hover
// @hv-txt {color} text color on hover
// @base-color {color} base border color | default: main text color
// @base-txt {color} base text color | default: main text color
.button-invert(@hv-color; @hv-txt: auto; @base-color: @hv-color; @base-txt: @hv-color; @visual-brd-width: 2px) {
	// 1. Calcul du contraste pour le texte AU SURVOL
	@final-txt-hover: if(@hv-txt = auto, contrast(@hv-color, #000, #fff, 43%), @hv-txt);

	// 2. Variables de couleurs (on utilise désormais les couleurs passées en paramètres)
	--btn-color: @base-txt;
	--btn-brd: @base-color;
	@media (prefers-color-scheme: dark) {
		--btn-color: #fff;
		--btn-brd: #fff;
	}
	@real-brd-width: 1px;
	@shadow-width: (@visual-brd-width - @real-brd-width);

	box-sizing: border-box;
	position: relative;

	// Garde la taille de 115px
	border: @real-brd-width solid var(--btn-brd);
	box-shadow: inset 0 0 0 @shadow-width var(--btn-brd);
	color: var(--btn-color);

	z-index: 2;
	.auto-transition(.25s);

	&:before {
		content: '';
		position: absolute;
		display: inline-block;
		height: calc(100% + (@real-brd-width * 2));
		width: 0;
		top: -@real-brd-width;
		left: -@real-brd-width;
		background-color: @hv-color;
		z-index: -1;
		transition: 0.25s;
		border-radius: @btn-border-radius-base;
	}

	&:hover {
		color: @final-txt-hover;
		border-color: @hv-color;
		box-shadow: inset 0 0 0 @shadow-width @hv-color;

		&:before {
			width: calc(100% + (@real-brd-width * 2));
		}
	}
}
// Button ghost curtain Style
// @color {color} background color on hover
// @hv-txt {color} text color on hover
// @visual-brd-width border size
// 1. EFFET RIDEAU (Haut vers Bas)
.button-ghost-curtain(@color; @hv-txt: auto; @visual-brd-width: 2px) {
	@final-txt-hover: if(@hv-txt = auto, contrast(@color, #000, #fff, 43%), @hv-txt);
	@real-brd-width: 1px;
	@shadow-width: (@visual-brd-width - @real-brd-width);

	--btn-color: @color;
	box-sizing: border-box;
	position: relative;
	z-index: 2;
	overflow: hidden;
	border: @real-brd-width solid @color;
	box-shadow: inset 0 0 0 @shadow-width @color;
	color: var(--btn-color);
	.auto-transition(.3s);

	&:before {
		content: '';
		position: absolute;
		width: calc(100% + (@real-brd-width * 2));
		height: 0;
		top: -@real-brd-width;
		left: -@real-brd-width;
		background-color: @color;
		z-index: -1;
		transition: height 0.3s ease-in-out;
		border-radius: @btn-border-radius-base;
	}

	&:hover {
		color: @final-txt-hover;
		&:before { height: calc(100% + (@real-brd-width * 2)); }
	}
}
// Button ghost reveal Style
// @color {color} background color on hover
// @hv-txt {color} text color on hover
// @visual-brd-width border size
// 2. EFFET OUVERTURE (Expansion centrale)
.button-ghost-reveal(@color; @hv-txt: auto; @visual-brd-width: 2px) {
	@final-txt-hover: if(@hv-txt = auto, contrast(@color, #000, #fff, 43%), @hv-txt);
	@real-brd-width: 1px;
	@shadow-width: (@visual-brd-width - @real-brd-width);

	--btn-color: @color;
	box-sizing: border-box;
	position: relative;
	z-index: 2;
	overflow: hidden;
	border: @real-brd-width solid @color;
	box-shadow: inset 0 0 0 @shadow-width @color;
	color: var(--btn-color);
	.auto-transition(.3s);

	&:before {
		content: '';
		position: absolute;
		width: calc(100% + (@real-brd-width * 2));
		height: calc(100% + (@real-brd-width * 2));
		top: -@real-brd-width;
		left: -@real-brd-width;
		background-color: @color;
		z-index: -1;
		transform: scaleY(0);
		transition: transform 0.3s ease-in-out;
		border-radius: @btn-border-radius-base;
	}

	&:hover {
		color: @final-txt-hover;
		&:before { transform: scaleY(1); }
	}
}
// Button ghost slide Style
// @color {color} background color on hover
// @hv-txt {color} text color on hover
// @visual-brd-width border size
.button-ghost-slide(@color-val; @hv-txt: auto; @visual-brd-width: 2px) {
	@final-txt-hover: if(@hv-txt = auto, contrast(@color-val, #000, #fff, 43%), @hv-txt);
	@real-brd-width: 1px;
	@shadow-width: (@visual-brd-width - @real-brd-width);

	--btn-color: @color-val;
	box-sizing: border-box;
	position: relative;
	z-index: 2;
	overflow: hidden; // Crucial pour couper la diagonale qui dépasse

	border: @real-brd-width solid @color-val;
	box-shadow: inset 0 0 0 @shadow-width @color-val;
	color: var(--btn-color);
	.auto-transition(.3s);

	&:before {
		content: '';
		position: absolute;
		top: 0;
		left: -150%; // On le sort loin à gauche
		width: 120%; // Plus large pour couvrir la diagonale
		height: 100%;
		background-color: @color-val;

		// L'astuce : On incline le fond de 25 degrés
		transform: skewX(-25deg);

		z-index: -1;
		transition: left 0.4s ease-in-out;
	}

	&:hover {
		color: @final-txt-hover;
		&:before {
			left: -10%; // Il glisse pour recouvrir tout le bouton
		}
	}
}
// Button invert Style
// @color-val {color} background color on hover
// @hv-txt {color} text color on hover
// @opacity
// @visual-brd-width: 2px
.button-invert-transparent(@color-val; @hv-txt: auto; @opacity: 0.7; @visual-brd-width: 2px) {
	// On utilise @color-val (la vraie couleur LESS) pour le contraste
	@final-txt-hover: if(@hv-txt = auto, contrast(@color-val, #000, #fff, 43%), @hv-txt);

	@real-brd-width: 1px;
	@shadow-width: (@visual-brd-width - @real-brd-width);

	box-sizing: border-box;
	position: relative;
	border: @real-brd-width solid @color-val;
	box-shadow: inset 0 0 0 @shadow-width @color-val;
	z-index: 2;
	.auto-transition(.25s);

	&:before {
		content: '';
		position: absolute;
		height: calc(100% + (@real-brd-width * 2));
		width: 0;
		top: -@real-brd-width;
		left: -@real-brd-width;

		// Utilisation de votre fonction d'opacité
		.hex-to-rgba(@color-val, @opacity);

		z-index: -1;
		transition: 0.25s;
		border-radius: @btn-border-radius-base;
	}

	&:hover {
		color: @final-txt-hover;
		&:before { width: calc(100% + (@real-brd-width * 2)); }
	}
}
// Theme buttons Styles
// Create 3 theme style :
// - btn-{@name} | Simple flat button
// - btn-{@name}-gradient |Button with gradient background
// - btn-{@name}-invert | Button with background color on hover
//
// Requires a @{name}-colors list of colors
.custom-button(@name, @txt-color: var(--white), @invert-base: var(--text-color)){
	@class: ~".btn-@{name}";

	// Variables de nommage pour les variables CSS
	@var: ~'--@{name}-color';
	@lighter: ~'--@{name}-color-lighter';
	@light: ~'--@{name}-color-light';
	@dark: ~'--@{name}-color-dark';

	// Récupération de la couleur LESS pour les calculs (indispensable pour contrast/lighten)
	@color: @theme-color[$@name];
	@ch: hue(@color);
	@cs: saturation(@color);
	@cl: lightness(@color);
	@ca: alpha(@color);

	// Couleurs dérivées pour le gradient
	@c-lighter: lighten(@color, 15%);
	@c-light: lighten(@color, 5%);
	@c-dark: darken(@color, 10%);

	.create-btn-set(@name) when not (@name = default) {
		.btn {
			&@{class} {
				// 1. VOTRE FONCTION DE BASE (Définit le bouton plein standard)
				.button-variant(@txt-color, @ch, @cs, @cl, @ca, @ch, @cs, @cl, @ca);

				// 2. LES VARIATIONS (Utilisent @color pour les calculs de contraste)
				&-gradient {
					// RESET : On désactive le fond solide pour laisser place au dégradé
					--btn-bg-color: transparent;
					--btn-hover-bg-color: transparent;
					.button-gradient(@color; @txt-color; @c-lighter; @c-light; @c-dark);
				}
				&-outline {
					.button-invert(@color; @txt-color; @color; @color);
				}
				&-invert {
					// RESET : On force le fond de base à être transparent
					--btn-bg-a: 0;
					--btn-hover-bg-a: 0;
					.button-invert(@color; @txt-color; @invert-base; @invert-base);
				}
				&-invert-transparent {
					// Version avec opacité 0.7
					.button-invert-transparent(@color; @txt-color; 0.7);
				}
				&-white {
					.button-invert(@color; @txt-color; #ffffff; #ffffff);
				}
				&-ghost-reveal {
					.button-ghost-reveal(@color; @txt-color);
				}
				&-ghost-curtain {
					// RESET : Le ghost est transparent au repos
					--btn-bg-a: 0;
					--btn-hover-bg-a: 0;
					.button-ghost-curtain(@color; @txt-color);
				}
				&-ghost-slide {
					// La version diagonale (Skewed) pour se différencier de l'outline
					.button-ghost-slide(@color; @txt-color);
				}
			}
		}
	};
	.create-btn-set(@name);
}

// Theme buttons Styles
// Create 3 theme style :
// - btn-{@name} | Simple flat button
// - btn-{@name}-gradient |Button with gradient background
// - btn-{@name}-invert | Button with background color on hover
//
// Requires a @{name}-colors list of colors
/*
.custom-button(@name,@txt-color: var(--white),@invert-base: var(--text-color)){
	@class: ~".btn-@{name}";

	@var: ~'--@{name}-color';
	@lighter: ~'--@{name}-color-lighter';
	@light: ~'--@{name}-color-light';
	@dark: ~'--@{name}-color-dark';
	//@ch: ~"--@{name}-color-h";
	//@cs: ~"--@{name}-color-s";
	//@cl: ~"--@{name}-color-l";
	//@ca: ~"--@{name}-color-a";
	@color: @theme-color[$@name];
	@ch: hue(@color);
	@cs: saturation(@color);
	@cl: lightness(@color);
	@ca: alpha(@color);

	.create-btn-set(@name) when not (@name = default) {
		.btn {
			&@{class} {
				.button-variant(@txt-color,@ch,@cs,@cl,@ca,@ch,@cs,@cl,@ca);

				//&-gradient {
				//	.button-gradient-variant(@txt-color, extract(@color, 2), extract(@color, 4));
				//}
				&-gradient {
					.button-gradient(var(@var); @txt-color; var(@lighter); var(@light); var(@dark) );
				}
				&-outline {
					.button-invert(var(@var); @txt-color; var(@var); var(@var));
				}
				&-invert {
					.button-invert(var(@var); @txt-color; @invert-base; @invert-base);
				}
				&-white {
					.button-invert(var(@var); @txt-color; @txt-color; @txt-color);
				}
			}
		}
	};
	.create-btn-set(@name);
}*/